<?phpnamespace frontend\components\common\user;use Yii;use yii\base\Object;use wokaextend\wechat\AuthOpenid;use wokaextend\wechat\config\WechatConfig;/** * Summary of UserBase * 微信用户基础类 *  * @author qiyo_vanzer * @deprec  date:2018.06.05 */class WxUserSim extends Object{    public $objSession=null;        /**     * Summary of init     * 验证用户信息     */    public  function __construct($wxid=1,$isSave=true)    {                     $this->objSession =Yii::$app->session;        if (Yii::$app->request->isAjax) {             //异步请求无法更新用户信息,跳过验证            return true;        }                       //缓存超时 则更新用户信息        if(empty($this->objSession["WX_S_Openid".$wxid]) || empty($this->objSession["WXU_S_Timeout".$wxid]) || $this->objSession["WXU_S_Timeout".$wxid] < time())        {            $this->objSession["WX_S_Openid".$wxid] ='';            //获取微信用户信息            $classAuthUser = new AuthOpenid();              $wxConfig=WechatConfig::getCongfig($wxid);            //获取登录用户openid            $classAuthUser->APPID=$wxConfig['wechatAPPID'];            $classAuthUser->SECRET=$wxConfig['wechatAPPSecret'];                    $classAuthUser->GetOpenid($wxid);                      //设置180秒缓存超时            $this->objSession["WXU_S_Timeout".$wxid]= time() +3000;		          }                          }        /**     * Summary of getUInfo     * 获取用户信息     * @return mixed     */    public function getOpenid($wxid=1)    {                return $this->objSession['WX_S_Openid'.$wxid];                   }        }