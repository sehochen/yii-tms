<?phpnamespace frontend\components\common\user;use Yii;use yii\base\Object;use wokaextend\wechat\AuthUserinfo;use wokaextend\wechat\config\WechatConfig;/** * Summary of UserBase * 微信用户基础类 *  * @author qiyo_vanzer * @deprec  date:2018.06.05 */class WxUserBase extends Object{    public $objSession=null;        /**     * Summary of init     * 验证用户信息     */    public  function __construct($wxid=1,$isSave=true)    {                     $this->objSession =Yii::$app->session;        if (Yii::$app->request->isAjax) {             //异步请求无法更新用户信息,跳过验证            return true;        }                       //缓存超时 则更新用户信息        if( empty(    $this->objSession["WXOpenid".$wxid] ) ||empty($this->objSession["WXUTimeout".$wxid]) || $this->objSession["WXUTimeout".$wxid] < time())        {            $this->objSession["WXOpenid".$wxid] ='';            //获取微信用户信息            $classAuthUser = new AuthUserinfo();              $wxConfig=WechatConfig::getCongfig($wxid);            //获取登录用户openid            $classAuthUser->APPID=$wxConfig['wechatAPPID'];            $classAuthUser->SECRET=$wxConfig['wechatAPPSecret'];                    $classAuthUser->getUserInfo($wxid,$isSave);                      //设置180秒缓存超时             $this->objSession["WXUTimeout".$wxid]= time() +30;		          }                          }         /**     * Summary of getUid     * 返回用户id     * @return mixed     */    public  function getUid($wxid=1)    {        $uid=$this->objSession['WXUserid'.$wxid];                return   empty($uid)?1:$uid;             }        /**     * Summary of getUInfo     * 获取用户信息     * @return mixed     */    public function getUInfo($wxid=1)    {                $userInfo=$this->objSession['WXUserInfo'.$wxid];                 return   empty($userInfo)? false :$userInfo;       }        }